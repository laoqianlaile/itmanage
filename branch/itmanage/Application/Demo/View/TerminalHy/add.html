<div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" data-dismiss="modal" class="close">
                <span aria-hidden="true">&times;</span>
            </button>
            <h4 class="modal-title">信息编辑</h4>
        </div>
        <form id="sys_dlg_form" role="form">
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="panel-body">
                            <div class="heng">
           <!--                      <div class="form-group_l form-inline">
                                    <label>设备类别</label>
                                    <input id="zd_name" name="zd_name" type="text" value="{$data.zd_name}" class="form-control">
                                    
                                </div>
                                <div class="form-group_r form-inline">
                                    <label>设备编码</label>
                                    <input id="zd_devicecode" name="zd_devicecode" type="text" value="{$data.zd_devicecode}" class="form-control">
                            
                                </div> -->
                                <div class="form-group_l form-inline">
                                    <label>设备名称</label>
                                    <input id="zd_name" name="zd_name" type="text" value="{$data.zd_name}" class="form-control">
                                </div>
                                <div class="form-group_r form-inline">
                                    <label>IP地址</label>
                                    <input id="zd_ipaddress" name="zd_ipaddress" type="text" value="{$data.zd_ipaddress}" class="form-control">
                                    <span style="color: #f00;">*</span>
                                </div>
                            </div>
                            <div class="heng">
                           <!--      <div class="form-group_l form-inline">
                                    <label>MAC地址</label>
                                    <input id="zd_macaddress" name="zd_macaddress" type="text" value="{$data.zd_macaddress}" class="form-control">
                                </div> -->
                         <!--        <div class="form-group_l form-inline">
                                    <label>状态</label>
                                    <select name="zd_status" id="zd_status" class="form-control" style="margin-bottom: -5px;width:65%;">
                                        <option value="">--请选择--</option>
                                        <option value="在用"  <if condition="($data.zd_status eq '在用')">selected="selected"</if>>在用</option>
                                        <option value="备用"  <if condition="($data.zd_status eq '备用')">selected="selected"</if>>备用</option>
                                        <option value="返修"  <if condition="($data.zd_status eq '返修')">selected="selected"</if>>返修</option>
                                        <option value="特殊"  <if condition="($data.zd_status eq '特殊')">selected="selected"</if>>特殊</option>
                                    </select>
                            
                                </div> -->
                             <!--    <div class="form-group_l form-inline">
                                    <label>厂家</label>
                                    <select name="zd_factoryname" class="form-control" id="zd_factoryname" style="margin-bottom: -5px;width:65%;">
                                        <option value="">--请选择--</option>
                                    </select>
                                </div>
                                <div class="form-group_r form-inline">
                                    <label>型号</label>
                                    <select name="zd_modelnumber" class="form-control" id="zd_modelnumber" style="margin-bottom: -5px;width:65%;">
                                        <option value="">--请选择--</option>
                                    </select>
                                </div>
                            </div> -->
                            <div class="heng">
                                <div class="form-group_r form-inline">
                                    <label>密级</label>
                          <!--           <select name="zd_secretlevel" id="zd_secretlevel" class="form-control" style="margin-bottom: -5px;width:65%;">
                                        <option value="">--请选择--</option>
                                        <foreach name="ds_miji" item="vo">
                                            <option value="{$vo.d_atpid}"
                                            <if condition="($data.zd_secretlevel eq $vo['d_atpid'])">
                                                selected="selected"
                                            </if>
                                            >{$vo.d_dictname}</option>
                                        </foreach>
                                    </select> -->
                                    <!-- <span style="color: #f00;">*</span> -->
                                      <input id="zd_secretlevel" name="zd_secretlevel" type="text" value="{$data.zd_secretlevel}" class="form-control">
                                </div>
                                <div class="form-group_l form-inline">
                                    <label>地区</label>
                              <!--       <select name="zd_area" class="form-control" id="zd_area" style="margin-bottom: -5px;width:65%;">
                                        <option value="">--请选择--</option>
                                        <foreach name="ds_area" item="vo">
                                            <option value="{$vo.d_atpid}"
                                            <if condition="($data.zd_area eq $vo['d_atpid'])">selected</if>>
                                            {$vo.d_dictname}</option>
                                        </foreach>
                                    </select> -->
                                     <input id="zd_area" name="zd_area" type="text" value="{$data.zd_area}" class="form-control">
                                    <!-- <span style="color: #f00;">*</span> -->
                                </div>
                                <div class="form-group_r form-inline">
                                    <label>楼宇</label>
                                <!--     <select name="zd_belongfloor" class="form-control" id="zd_belongfloor" style="margin-bottom: -5px;width:65%;">
                                        <!--<option value=""></option>-->
                                <!--     </select> --> 
                                    <input id="zd_belongfloor" name="zd_belongfloor" type="text" value="{$data.zd_belongfloor}" class="form-control">
                                
                                </div>
                           <!--      <div class="form-group_l form-inline">
                                    <label>房间号</label>
                                    <input id="zd_roomno" name="zd_roomno" type="text" value="{$data.zd_roomno}" class="form-control">
                                 
                                </div> -->
                            </div>
                           <!--  <div class="heng">
                                <div class="form-group_l">
                                    <label>责任人</label>
                                    <select name="zd_dutyman" class="chosen-select_longajax" id="zd_dutyman" style="margin-bottom: -5px;width:56%;" multiple>
                                        <option value=""></option>
                                    </select>
                                </div>
                                <div class="form-group_dept">
                                    <label>责任部门</label>
                                    <select name="zd_dutydeptid" class="chosen-select_longajaxs" id="zd_dutydeptid" style="margin-bottom: -5px;width:83%;" multiple>
                                        <option value=""></option>
                                    </select>
                                </div>
                                <div class="form-group_r form-inline">
                                    <label>启用日期</label>
                                    <input id="zd_startusetime" name="zd_startusetime" type="text" value="{$data.zd_startusetime}" onClick="WdatePicker({dateFmt:'yyyy-MM-dd'})" class="form-control">
                                </div>
                            </div> -->
                         <!--    <div class="heng1">
                                <div class="form-group_heng">
                                    <label style="float: left; width: 7%;">备注</label>
                                    <textarea id="zd_memo" name="zd_memo" class="form-control" style="width: 91%;" rows="2">{$data.zd_memo}</textarea>
                                </div>
                            </div> -->
                            <input id="zd_atpid" name="zd_atpid" type="hidden" value="{$data.zd_atpid}">
                            <input id="zd_type" name="zd_type" type="hidden" value="guidDA36A81A-15B6-4D11-9857-B67391CF9C0A">
                        </div>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-default">关闭</button>
                <input type="submit" id="sys_dlg_submit" value="保存" class="btn btn-primary"/>
                <!--<button type="button" data-dismiss="modal" id="sys_dlg_submit" class="btn btn-primary">保存</button>-->
            </div>
        </form>
    </div>
</div>

<!--<link rel="shortcut icon" href="favicon.ico"> <link href="__PUBLICOLD__/vendor/tabs/css/bootstrap.min.css?v=3.3.5" rel="stylesheet">-->
<!--<link href="__PUBLICOLD__/vendor/tabs/css/font-awesome.css?v=4.4.0" rel="stylesheet">-->
<!--<link href="__PUBLICOLD__/vendor/tabs/css/animate.css" rel="stylesheet">-->
<!--<link href="__PUBLICOLD__/vendor/tabs/css/style.css?v=4.0.0" rel="stylesheet"> -->
<style type="text/css">
    .modal-dialog {
        width: 94%;
        height: 80%;
    }

    .col-sm-6 {
        width: 100%;
    }

    .heng {
        width: 100%;
        height: 50px;
    }

    .heng1 {
        width: 100%;
        height: 70px;
    }

    .form-group_heng {
        width: 100%;
        height: 50px;
    }

    .form-group_l {
        width: 25%;
        float: left;
    }

    .form-group_r {
        width: 25%;
        float: left;
    }

    .form-group_r label {
        width: 28% !important;
        float: left;
        margin-top: 7px;
    }
    .form-group_dept {
        width: 50%;
        float: left;
    }

    .form-group_dept label {
        width: 14%;
        float: left;
        margin-top: 7px;
    }

    .form-group_dept .form-control {
        width: 83% !important;
    }

    .form-group_l label {
        width: 28% !important;
        float: left;
        margin-top: 7px;
    }

    /*.heng div label{width:20%;float: left;margin-top: 7px;}*/
    .form-control {
        width: 65% !important;
    }

    .form-group_21 {
        width: 33.3%;
        float: left;
    }

    .form-group_22 {
        width: 33.3%;
        float: left;
    }

    .form-group_23 {
        width: 33.3%;
        float: left;
    }

    .fengetitle {
        height: 40px;
        margin-bottom: 10px;
        font-size: 20px;
        font-family: 微软雅黑;
        text-align: center;
        line-height: 40px;
        width: 60%;
        margin-left: 20%;
        border-bottom: 1px solid #cdcdcd;
    }
    .chosen-select_longajax>.chosen-container, .chosen-container-multi{
        max-height:60px;
        height:100%
    }

</style>

<script type="text/javascript">
    $(document).ready(function (e) {
        // $(".js-switch").each(function () {
        //     new Switchery(this, {color: '#1AB394'});
        // });
        /*here for edit 下拉框多级联动自动选中*/
        // var area = $("#netdevizd_area:selected").val();
        // $.post('__CONTROLLER__/getbuilding', {area: area}, function (rep) {
        //     var typearr = eval("(" + rep + ")");
        //     if (typearr.length > 0) {
        //         $("#zd_belongfloor").children().remove();
        //         var item = "";
        //         for (var i = 0; i < typearr.length; i++) {
        //             item += "<option value='" + typearr[i]['d_atpid'] + "'";
        //             if (typearr[i]['d_atpid'] == "{$data.zd_belongfloor}")
        //                 item += " selected>" + typearr[i]['d_dictname'] + "</option>";
        //             else

        //                 item += ">" + typearr[i]['d_dictname'] + "</option>";

        //         }
        //         $("#zd_belongfloor").append(item);
        //     }
        //     else {
        //         $("#zd_belongfloor").children().remove();
        //     }

        // });
//         var sbtype = '154110';
//         $.post('__CONTROLLER__/getfactory', {sbtype: sbtype,options: 0}, function (rep) {
//             var typearr = eval("(" + rep + ")");
//             if (typearr.length > 0) {
//                 $("#zd_factoryname").children().remove();
//                 var item = "<option></option>";
//                 for (var i = 0; i < typearr.length; i++) {
//                     item += "<option value='" + typearr[i]['d_atpid'] + "'";
//                     if (typearr[i]['d_atpid'] == "{$data.zd_factoryname}")
//                         item += " selected>" + typearr[i]['d_dictname'] + "</option>";
//                     else
//                         item += ">" + typearr[i]['d_dictname'] + "</option>";
//                 }
//                 $("#zd_factoryname").append(item);
//             }
//             else
//                 $("#zd_factoryname").children().remove();
//             var factory = $("#zd_factoryname option:selected").val();
//             $.post('__CONTROLLER__/getmodel', {factory: factory}, function (rep) {
//                 var typearr = eval("(" + rep + ")");
//                 if (typearr.length > 0) {
// //                    alert(typearr.length);
//                     $("#zd_modelnumber").children().remove();
//                     var item = "";
//                     for (var i = 0; i < typearr.length; i++) {
//                         item += "<option value='" + typearr[i]['d_atpid'] + "'";
//                         if (typearr[i]['d_atpid'] == "{$data.zd_modelnumber}")
//                             item += " selected>" + typearr[i]['d_dictname'] + "</option>";
//                         else
//                             item += ">" + typearr[i]['d_dictname'] + "</option>";
//                     }
//                     $("#zd_modelnumber").append(item);
//                 }
//                 else
//                     $("#zd_modelnumber").children().remove();


//             });
        // });

        // $(".chosen-select_longajax").chosen({disable_search_threshold: 10, search_contains: true, width: '65%'});
        // $(".chosen-select_longajaxs").chosen({disable_search_threshold: 10, search_contains: true, width: '83%'});
        // $('#zd_dutyman').append('<option value="{$data.zd_dutyman}" selected="selected">{$data.zd_dutymanname}</option>');
        // $('#zd_dutyman').trigger("chosen:updated");
        // var zd_dutyman = $("#zd_dutyman option:selected").val();
        // $.post('__CONTROLLER__/getdutydept', {dutyman: zd_dutyman}, function (rep) {
        //     var typearr = eval("(" + rep + ")");
        //     if (typearr.length > 0) {
        //         $("#zd_dutydeptid").children().remove();
        //         var item = "";
        //         for (var i = 0; i < typearr.length; i++) {
        //             item += "<option value='" + typearr[i]['id'] + "'";
        //             if (typearr[i]['id'] == "{$data.zd_dutydeptid}")
        //                 item += " selected>" + typearr[i]['fullname'] + "</option>";
        //             else
        //                 item += ">" + typearr[i]['fullname'] + "</option>";
        //         }
        //         $("#zd_dutydeptid").append(item);
        //     }
        //     else
        //         $("#zd_dutydeptid").children().remove();
        // });

        // $('#zd_dutyman').ajaxChosen({
        //     dataType: 'json',
        //     type: 'POST',
        //     url: '__CONTROLLER__/assignuser'
        // }, {
        //     loadingImg: '__PUBLICOLD__/vendor/chosen-ajax-addition/example/loading.gif'
        // });
        // $('#zd_dutyman').trigger("chosen:updated");

        // $('#zd_dutydeptid').ajaxChosen({
        //     dataType: 'json',
        //     type: 'POST',
        //     url:'__CONTROLLER__/assigndept'
        // },{
        //     loadingImg: '__PUBLICOLD__/vendor/chosen-ajax-addition/example/loading.gif'
        // });

        $.validator.setDefaults({
            highlight: function (element) {
                $(element).closest('.form-group').remove('has-success').addClass('has-error');
            },
            success: function (element) {
                $(element).closest('.form-group').remove('has-error').addClass('has-success');
            },
            errorElement: 'span',
            errorPlacement: function (error, element) {
                if (element.is(":radio") || element.is(":checkbox")) {
                    error.appendTo(element.parent().parent().parent());
                } else {
                    error.appendTo(element.parent());
                }
            },
            errorClass: "help-block m-b-none",
            validClass: "help-block m-b-none"
        });
        $.validator.addMethod("checkip", function (value, element) {
            var ipaddr = $('#zd_ipaddress').val();
            var flag = ip_verify(ipaddr);
            return flag;
        });
        $.validator.addMethod("checkmac", function (value, element) {
            var macaddr = $('#zd_macaddress').val();
            var flag = mac_verify(macaddr);
            return flag;
        });
        $("#sys_dlg_form").validate({
            rules: {
                // zd_name: "required",          // 设备名称
                // zd_devicecode: "required",    // 设备编码
                zd_ipaddress: {
                    required: "true",
                    checkip: "true"
                },
                // zd_status: "required", //状态
                // zd_secretlevel: "required", //密级
                // zd_area: "required",　//地区
                // zd_belongfloor: "required", //楼宇
                // zd_roomno: "required", //房间号

            },
            messages: {
                // zd_name: "必填",
                // zd_devicecode: "必填",
                zd_ipaddress: {
                    required: "必填",
                    checkip: "IP地址不合法"
                },
                // zd_status: "必填",
                // zd_secretlevel: "必填",
                // zd_area: "必填",
                // zd_belongfloor: "必填",
                // zd_roomno: "必填"

            },
            submitHandler: function () {
                var zd_atpid        = $('#zd_atpid').val();
                var zd_name         = $('#zd_name').val();
                // var zd_devicecode   = $('#zd_devicecode').val();
                // var zd_seqno        = $('#zd_seqno').val();
                var zd_ipaddress    = $('#zd_ipaddress').val();
                // var zd_macaddress   = $('#zd_macaddress').val();
                // var zd_status       = $('#zd_status').val();
                // var zd_factoryname  = $('#zd_factoryname').val();
                // var zd_modelnumber  = $('#zd_modelnumber').val();
                var zd_secretlevel  = $('#zd_secretlevel').val();
                var zd_area         = $('#zd_area').val();
                var zd_belongfloor  = $('#zd_belongfloor').val();
                // var zd_roomno       = $('#zd_roomno').val();
                // var zd_dutyman      = $('#zd_dutyman').val();
                // var zd_dutydeptid   = $('#zd_dutydeptid').val();
                // var zd_startusetime = $('#zd_startusetime').val();
                // var zd_memo         = $('#zd_memo').val();
                var zd_type         = $('#zd_type').val();
                $.post(
                        '__CONTROLLER__/HYsubmit',
                        {
                            zd_atpid:zd_atpid,
                            zd_name:zd_name,
                            // zd_devicecode:zd_devicecode,
                            // zd_seqno:zd_seqno,
                            zd_ipaddress:zd_ipaddress,
                            // zd_macaddress:zd_macaddress,
                            // zd_status:zd_status,
                            // zd_factoryname:zd_factoryname,
                            // zd_modelnumber:zd_modelnumber,
                            zd_secretlevel:zd_secretlevel,
                            zd_area:zd_area,
                            zd_belongfloor:zd_belongfloor,
                            // zd_roomno:zd_roomno,
                            // zd_dutyman:zd_dutyman,
                            // zd_dutydeptid:zd_dutydeptid,
                            // zd_startusetime:zd_startusetime,
                            // zd_memo:zd_memo,
                            zd_type:zd_type
                        },
                        function (data) {
                    if ("success" == data) {
                        $("#sys_dlg").modal("hide");
                        $('#atpbiztable').bootstrapTable("refresh");
                    } else {
                        alert('保存失败');
                    }
                });
            }

        });
    });
    // $('#zd_factoryname').on('change', function () {
    //     var factory = $("#zd_factoryname option:selected").val();
    //     $.post('__CONTROLLER__/getmodel', {factory: factory}, function (rep) {
    //         var typearr = eval("(" + rep + ")");
    //         if (typearr.length > 0) {
    //             $("#zd_modelnumber").children().remove();
    //             var item = "<option value=''>--请选择--</option>";
    //             for (var i = 0; i < typearr.length; i++) {
    //                 item += "<option value='" + typearr[i]['d_atpid'] + "'";
    //                 if (typearr[i]['d_atpid'] == "{$data.zd_modelnumber}")
    //                     item += " selected>" + typearr[i]['d_dictname'] + "</option>";
    //                 else
    //                     item += ">" + typearr[i]['d_dictname'] + "</option>";
    //             }
    //             $("#zd_modelnumber").append(item);
    //         }
    //         else
    //             $("#zd_modelnumber").children().remove();

    //     });
    // });
    // $('#zd_area').on('change', function () {
    //     var area = $("#zd_area option:selected").val();
    //     $.post('__CONTROLLER__/getbuilding', {area: area}, function (rep) {
    //         var typearr = eval("(" + rep + ")");
    //         if (typearr.length > 0) {
    //             $("#zd_belongfloor").children().remove();
    //             var item = "<option value=''>--请选择--</option>";
    //             for (var i = 0; i < typearr.length; i++) {
    //                 item += "<option value='" + typearr[i]['d_atpid'] + "'";
    //                 if (typearr[i]['d_atpid'] == "{$data.zd_belongfloor}")
    //                     item += " selected>" + typearr[i]['d_dictname'] + "</option>";
    //                 else
    //                     item += ">" + typearr[i]['d_dictname'] + "</option>";
    //             }
    //             $("#zd_belongfloor").append(item);
    //         }
    //         else {
    //             $("#zd_belongfloor").children().remove();
    //         }


    //     });
    // });
    // $('#zd_dutyman').on('change', function () {
    //     var zd_dutyman = $("#zd_dutyman option:selected").val();

    //     $.post('__CONTROLLER__/getdutydept', {dutyman: zd_dutyman}, function (rep) {
    //         var typearr = eval("(" + rep + ")");
    //         if (typearr.length > 0) {
    //             $("#zd_dutydeptid").children().remove();
    //             var item = "";
    //             for (var i = 0; i < typearr.length; i++) {
    //                 item += "<option value='" + typearr[i]['id'] + "'";
    //                 if (typearr[i]['id'] == "{$data.zd_dutydeptid}"){
    //                     item += " selected>" + typearr[i]['fullname'] + "</option>";
    //                 }else{
    //                     item += ">" + typearr[i]['fullname'] + "</option>";
    //                 }
    //             }
    //             $("#zd_dutydeptid").append(item);
    //         }
    //         else
    //             $("#zd_dutydeptid").children().remove();
    //     });
    // });
    function ip_verify(addr) {
        var reg = /^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){3}$/;
        if (addr.match(reg)) {
            return true;
        }
        else {
            return false;
        }
    }
    // function mac_verify(addr) {
    //     var reg = /[A-Fa-f0-9]{4}.[A-Fa-f0-9]{4}.[A-Fa-f0-9]{4}/;
    //     if (addr.match(reg)) {
    //         return true;
    //     }
    //     else {
    //         return false;
    //     }
    // }
</script>
