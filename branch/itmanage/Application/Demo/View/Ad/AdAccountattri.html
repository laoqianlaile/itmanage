<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>属性设置</title>

    <!--[if lte IE 8]>
    <script type="text/javascript" src="__PUBLICOLD__/vendor/ie8/es5-shim.min.js"></script>
    <![endif]-->

    <link href="__PUBLICOLD__/vendor/bootstrap-table/bootstrap/css/bootstrap.min.css" rel="stylesheet" >
    <link href="__PUBLICOLD__/adminframework/css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="__PUBLICOLD__/adminframework/css/plugins/chosen/chosen.css" rel="stylesheet">
    <link href="__PUBLICOLD__/adminframework/css/plugins/switchery/switchery.css" rel="stylesheet">
    <link href="__PUBLICOLD__/vendor/bootstrap-table/bootstrap-table/src/bootstrap-table.css" rel="stylesheet" >
    <link href="__PUBLICOLD__/adminframework/css/animate.css" rel="stylesheet">
    <link href="__PUBLICOLD__/adminframework/css/style.css?v=4.0.0" rel="stylesheet">
    <link rel="stylesheet" href="__PUBLICOLD__/vendor/ztree/css/zTreeStyle/zTreeStyle.css" type="text/css">

    <script src="__PUBLICOLD__/vendor/bootstrap-table/jquery.min.js"></script>
    <script src="__PUBLICOLD__/vendor/bootstrap-table/bootstrap/js/bootstrap.min.js"></script>
    <script src="__PUBLICOLD__/vendor/My97DatePicker/WdatePicker.js"></script>
    <script src="__PUBLICOLD__/adminframework/js/plugins/chosen/chosen.jquery.js"></script>
    <script src="__PUBLICOLD__/adminframework/js/plugins/chosen/chosen.order.jquery.js"></script>
    <script src="__PUBLICOLD__/vendor/chosen-ajax-addition/chosen.ajaxaddition.jquery.js"></script>

    <script src="__PUBLICOLD__/adminframework/js/plugins/prettyfile/bootstrap-prettyfile.js"></script>
    <script src="__PUBLICOLD__/adminframework/js/plugins/switchery/switchery.js"></script>
    <script src="__PUBLICOLD__/vendor/bootstrap-table/bootstrap-table/src/bootstrap-table.js"></script>
    <script src="__PUBLICOLD__/vendor/bootstrap-table/bootstrap-table/src/locale/bootstrap-table-zh-CN.js"></script>
    <script type="text/javascript" src="__PUBLICOLD__/vendor/ztree/js/jquery.ztree.core.js"></script>
    <script src="__PUBLICOLD__/adminframework/js/plugins/validate/jquery.validate.min.js"></script>

    <!--[if lt IE 9]>
    <script src="__PUBLICOLD__/vendor/ie8/html5shiv.js"></script>
    <script src="__PUBLICOLD__/vendor/ie8/respond.min.js"></script>
    <![endif]-->

     
    <style>
        .name{background-color:#f0f7f5; font-weight:bold; margin-top:30px; margin-bottom:20px; float:left;border-left:#18a689 8px solid; padding-left: 15px;line-height: 38px;height:38px;}
        .tt{ size: 20px; font-weight:bold; padding-left:40px;color:#03513f;margin:0px;}
        .col-sm-6{
            width:50%;
        }
        .col-sm-12{
            width:100%;
        }
    </style>
</head>

<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="ibox float-e-margins">
        <form id="atpform" role="form"　class="form-inline">
            <div class="ibox-content" style="padding:5%;padding-top:1%;">
                <div style="margin-top:20px;width:100%;">
                    <p class="tt">属性修改</p>
                    <p class="name" style="text-align: left;font-size: 20px;width:100%;">用户信息</p>
                </div>
                <div class="row row-lg" style="margin-top:10px;width:100%;">
                    <div class="form-group form-inline">
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable" style="width:15%;margin-right:2%">登录名：</label>
                            <input  id="SAMAccountName" name="SAMAccountName" type="text" class="form-control" readonly="true" value="{$SAMAccountName}">
                            <!--<font color="orangered">*</font>-->
                        </div>
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable  " style="width:17%;margin-right:2%;">姓&emsp;名：</label>
                            <input  id="DisplayName" name="DisplayName" type="text" class="form-control" value="{$DisplayName}">
                        </div>
                    </div>
                </div>
                <div style="margin-top:20px;width:100%;">
                    <p class="name" style="text-align: left;font-size: 20px;width:100%;">常&nbsp;规</p>
                </div>
                <div class="row row-lg" style="margin-top: 25px;">
                    <div class="col-sm-12 form-inline">
                        <label class="control-lable" style="width:7%;margin-right:1%;">描&emsp;述：</label>
                        <textarea class="form-control" rows="3" id="desc" name="desc" style="width:70.5%;">{$Description}</textarea>
                    </div>
                </div>
                <div style="margin-top:20px;width:100%;">
                    <p class="name" style="text-align: left;font-size: 20px;width:100%;">账户选项</p>
                </div>
                <div class="row row-lg" style="margin-top:20px;width:100%;">
                    <div class="form-group form-inline">
                        <div class="col-sm-6 form-inline">
                            <input  id="AccountDisable" name="AccountDisable" type="checkbox" class="form-control" required="true" <if condition="$AccountDisable != ''">checked</if>>
                            <label class="control-lable" style="width:50%;margin-left:2%">账户已禁用</label>
                        </div>
                        <div class="col-sm-6 form-inline">
                            <input  id="AccountLockout" name="AccountLockout" type="checkbox" class="form-control" required="true" <if condition="$AccountLockout == ''">disabled<else/>checked</if>>
                            <label class="control-lable" style="width:50%;margin-left:2%">账户已锁定</label>
                        </div>
                    </div>
                </div>
                <div style="margin-top:20px;width:100%;">
                    <p class="name" style="text-align: left;font-size: 20px;width:100%;">账&nbsp;户</p>
                </div>
                <div class="row row-lg" style="margin-top:20px;width:100%;">
                    <div class="form-group form-inline">
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable" style="width:15%;margin-right:2%">登录到：</label>
                            <input  id="loginto" name="loginto" type="text" class="form-control" style="width:;" >
                            <button class="btn btn-primary" type="button" id="choosecomp" style="padding-top: 4px;height: 35px;margin-top: 4px;margin-left:3%">确定</button>
                        </div>
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable  " style="width:20%;margin-right:1%;">从模板选择：</label>
                            <select class="chosen-select_longajax" id="logintomodel" style="margin-bottom: -5px; width: 56%;">
                                <option value=""></option>
                                <foreach name="modelInfo" item="vo">
                                    <option value="{$vo.d_detail}">{$vo.d_dictname}：{$vo.d_detail}</option>
                                </foreach>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row row-lg" style="margin-top: 20px;">
                    <div class="col-sm-12 form-inline">
                        <label class="control-lable" style="width:7%;margin-right:1%;"></label>
                        <!--<textarea class="form-control" rows="3" id="cominfo" name="cominfo" style="width:67%;"></textarea>-->
                        <select id="select_computer" data-placeholder=" " name="select_computer" class="chosen-select_long" multiple >
                            <option value="" checked></option>
                        </select>
                    </div>
                </div>
                <div style="margin-top:20px;width:100%;">
                    <p class="name" style="text-align: left;font-size: 20px;width:100%;">其他信息</p>
                </div>
                <div class="row row-lg" style="margin-top:20px;width:100%;">
                    <div class="form-group form-inline">
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable" style="width:15%;margin-right:2%">公&emsp;司：</label>
                            <input  id="companyname" name="companyname" type="text" class="form-control" value="{$Company}">
                        </div>
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable  " style="width:19%;margin-right:2%;">邮政信箱：</label>
                            <input  id="email" name="email" type="text" class="form-control" value="{$PostOfficeBox}">
                        </div>
                    </div>
                </div>
                <div class="row row-lg" style="margin-top:20px;width:100%;">
                    <div class="form-group form-inline">
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable" style="width:15%;margin-right:2%">部&emsp;门：</label>
                            <input  id="deptname" name="deptname" type="text" class="form-control" value="{$Department}">
                        </div>
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable  " style="width:19%;margin-right:2%;">邮政编码：</label>
                            <input  id="postcode" name="postcode" type="text" class="form-control" value="{$PostalCode}">
                        </div>
                    </div>
                </div>
                <div class="row row-lg" style="margin-top:20px;width:100%;">
                    <div class="form-group form-inline">
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable" style="width:15%;margin-right:2%">市\县：</label>
                            <input  id="city" name="city" type="text" class="form-control" value="{$L}">
                        </div>
                        <div class="col-sm-6 form-inline">
                            <label class="control-lable  " style="width:19%;margin-right:2%;">街&emsp;道：</label>
                            <input  id="road" name="road" type="text" class="form-control" value="{$StreetAddress}">
                        </div>
                    </div>
                </div>
                <div class="row row-lg" style="margin-top:55px;">
                    <div class="form-group" style="margin-bottom: 0px;">
                        <label class="control-lable  col-sm-4"></label>
                        <button class="btn btn-primary" type="button" id="submit">提交</button>
                        <label class="control-lable" style="width:10%">&nbsp;</label>
                        <button class="btn btn-primary " type="button" id="cancel">取消</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="modal fade" id="loading" role="dialog" data-backdrop='static'>
        <div class="modal-dialog" >
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel">处理中</h4>
                </div>
                <div class="modal-body">
                    <img src="__PUBLICOLD__/img/loading/loading8.gif" style='display: block;margin: 0 auto'>
                    <div id="loadingText" style="text-align: center"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    CHOSEN_DEFAULT_TEXT ="";
</script>
<script>
    $(function () {
//        $("#loadingText").html("正在处理请稍后");
//        $('#loading').modal('show');
        $(".chosen-select_long").chosen({disable_search_threshold: 10, search_contains: false,width:'40%',height:'88px !imprtant'});
        $(".chosen-select_longajax").chosen({disable_search_threshold: 10, search_contains: false,width:'70%'});

        //写入登录到
        var UserWorkstations = '<?php echo  $UserWorkstations;?>';
        if(UserWorkstations != ''){
            UserWorkstations = eval(UserWorkstations);
            UserWorkstations = UserWorkstations.split(',');
            for(var i = 0;i<UserWorkstations.length;i++){
                $('#select_computer').append('<option value="'+ UserWorkstations[i]+'" selected  >'+UserWorkstations[i]+'</option>');
            }
            $('#select_computer').trigger("chosen:updated");
        }

        //删除
//        $(".chosen-select_long option").remove();
        $('#choosecomp').on('click',function(){
            var loginto = $("#loginto").val();
            if(loginto != ''){
                $('#select_computer').append('<option value="'+loginto+'" selected  >'+loginto+'</option>');
                $('#select_computer').trigger("chosen:updated");
            }
        });

        $('#cancel').click(function(){
            history.go(-1);
        })
    });

    $('#logintomodel').on('change',function(){
        var modelVal = $('#logintomodel').val();
        if(modelVal != ''){
            $('#select_computer').children().remove();
            if(modelVal.indexOf(',')<0){
                var modelVals = modelVal.split(';');
            }else{
                var modelVals = modelVal.split(',');
            }
            for(var i = 0;i<modelVals.length;i++){
                $('#select_computer').append('<option value="'+modelVals[i]+'" selected  >'+modelVals[i]+'</option>');
            }
            $('#select_computer').trigger("chosen:updated");
        }
    });

    $('#submit').on('click',function (){
        var DisplayName   = $('#DisplayName');
        var desc       = $('#desc');
        var res = checkSub([DisplayName,desc]); //验证非空
        if(!res) return false;
        $.ajax({
                type:'post',
                url:'__CONTROLLER__/SetAccountAttr',
                data:{
                    strSAMAccountName:$('#SAMAccountName').val(),
                    DisplayName:$('#DisplayName').val(),
                    Description:$('#desc').val(),
                    AccountLockout:$('#AccountLockout').is(':checked'),
                    AccountDisable:$('#AccountDisable').is(':checked'),
                    select_computer:$('#select_computer').val(),
                    Company:$('#companyname').val(),
                    Department:$('#deptname').val(),
                    L:$('#city').val(),
                    PostOfficeBox:$('#email').val(),
                    PostalCode:$('#postcode').val(),
                    StreetAddress:$('#road').val(),
                },
                beforeSend:function(){
                    $("#loadingText").html("正在处理请稍后");
                    $('#loading').modal('show');
                },
                success:function(res){
//                    alert(res);return false;
                    if(res.code != 0){
                        alert(res.message);
                        return false;
                    }else{
                        alert('修改属性成功！');
                        window.history.go(-1);
                    }
                },
                complete:function(){
                    $('#loading').modal('hide');
                },
                dataType:'json'
        });
    });

    function checkSub(para){
        var err  = 0;
        for(var i = 0;i<para.length;i++){
            if(para[i].val() == ''){
                para[i].parent().addClass('has-error');
                err = 1;
            }else{
                para[i].parent().removeClass('has-error');
                para[i].parent().addClass('has-success');
            }
        }
        if(err == 1){
            return false;
        }else{
            return true;
        }
    }
</script>
</body>

</html>




